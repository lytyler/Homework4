---
title: "Task 3: Combining Excel and Delimited Data"
author: Lanette Tyler
format: html
toc: TRUE
editor_options: 
  chunk_output_type: console
---

## Load readxl, dplyr, readr packages:

```{r}
library(readxl)
library(dplyr)
library(readr)
```

## Read in and manipulate data

1.  Import White Wine Data:

```{r}
white_wine_data <- read_excel("../white-wine.xlsx")
white_wine_data
```

2.  Standardize Column Names for White Wine Data:

-   Read in data from second excel sheet of white wine data (variable names)
-   Overwrite column names

```{r}
excel_sheets("../white-wine.xlsx") #find name of second sheet
var_names <- read_excel("../white-wine.xlsx", sheet = "variables") #read in second sheet
var_names #view variable names
for (i in 1:dim(white_wine_data)[2]) {
  colnames(white_wine_data)[i] <- var_names[i,]
} #overwrite column names with those from the second excel sheet
white_wine_data #view data with overwritten column names
```

3.  Add a column to indicate that these wines are white:

```{r}
white_wine_data <- white_wine_data |>
  mutate(wine_type = "white")
white_wine_data #view data with wine_type variable added
```

4.  Read in and manipulate red wine data:

-   Read in red wine data
-   Check column types
-   Overwrite column names
-   Add wine_type variable

```{r}
red_wine_data <- read_delim("https://www4.stat.ncsu.edu/online/datasets/red-wine.csv", 
                            delim = ";") #read in data
for (i in 1:dim(red_wine_data)[2]) {
  colnames(red_wine_data)[i] <- var_names[i,]
} #overwrite column names to standardize
red_wine_data <- red_wine_data |> 
  mutate(wine_type = "red")
red_wine_data
```

## Combine data and manipulate further

5. Combine the datasets:

```{r}
wine_data <- bind_rows(white_wine_data, red_wine_data)
```

6. Filter

7. Sort

8. Select columns

9. Add mean and standard deviation of alcohol variable grouped by quality:

```{r}
wine_data <- wine_data |>
  filter(quality > 6.5, alcohol < 132) |>
  arrange(desc(quality)) |>
  select(contains("acid"), alcohol, wine_type, quality) |> 
  group_by(quality) |>
  mutate(mean_alcohol = mean(alcohol), sd_alcohol = sd(alcohol))
wine_data
```

